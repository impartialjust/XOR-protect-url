<html>

<head>
    <title>XOR Encryption4</title>
    <script language="JavaScript">
        //<!-- This script and many more are available free online at -->
        //<!-- The JavaScript Source!! http://javascript.internet.com -->

        //<!-- Begin
        /************************************************************************
         * Copyright 2001 by Terry Yuen.
         * Email: kaiser40@yahoo.com
         * Last update: July 15, 2001.
         * To implement this script onto your page, copy and paste the Javascript
         * on this page and place it in the page that you want the encryption
         * routine available on. Then use the function "encrypt()" to encrypt
         * data. This function takes two parameters. The first parameter is the
         * plain text string and the second parameter is the key. The returned
         * string is the encrypted string. To decrypt the string, use the
         * function "decrypt()" with the encrypted string as the first parameter
         * and key as the second parameter. It returns the decrypted string.
         *
         * Examples:
         * var secret = encrypt("My surprise will consist of ....", "password");
         * document.writeln(secret);
         *
         * document.form[0].elements[1].value = decrypt(document.form[0].elements[0].value, "password");
         *
         *************************************************************************/
        //End -->

        function encrypt(str, pwd) {
            if (pwd == null || pwd.length <= 0) {
                alert("Please enter a password with which to encrypt the message.");
                return null;
            }
            var prand = "";
            for (var i = 0; i < pwd.length; i++) {
                prand += pwd.charCodeAt(i).toString();
            }
            var sPos = Math.floor(prand.length / 5);
            var mult = parseInt(prand.charAt(sPos) + prand.charAt(sPos * 2) + prand.charAt(sPos * 3) + prand.charAt(sPos * 4) + prand.charAt(sPos * 5));
            var incr = Math.ceil(pwd.length / 2);
            var modu = Math.pow(2, 31) - 1;
            if (mult < 2) {
                alert("Algorithm cannot find a suitable hash. Please choose a different password. \nPossible considerations are to choose a more complex or longer password.");
                return null;
            }
            var salt = Math.round(Math.random() * 1000000000) % 100000000;
            prand += salt;
            while (prand.length > 10) {
                prand = (parseInt(prand.substring(0, 10)) + parseInt(prand.substring(10, prand.length))).toString();
            }
            prand = (mult * prand + incr) % modu;
            var enc_chr = "";
            var enc_str = "";
            for (var i = 0; i < str.length; i++) {
                enc_chr = parseInt(str.charCodeAt(i) ^ Math.floor((prand / modu) * 255));
                if (enc_chr < 16) {
                    enc_str += "0" + enc_chr.toString(16);
                } else enc_str += enc_chr.toString(16);
                prand = (mult * prand + incr) % modu;
            }
            salt = salt.toString(16);
            while (salt.length < 8) salt = "0" + salt;
            enc_str += salt;
            return enc_str;
        }

        function decrypt(str, pwd) {
            if (str == null || str.length < 8) {
                alert("A salt value could not be extracted from the encrypted message because it's length is too short. The message cannot be decrypted.");
                return;
            }
            if (pwd == null || pwd.length <= 0) {
                alert("Please enter a password with which to decrypt the message.");
                return;
            }
            var prand = "";
            for (var i = 0; i < pwd.length; i++) {
                prand += pwd.charCodeAt(i).toString();
            }
            var sPos = Math.floor(prand.length / 5);
            var mult = parseInt(prand.charAt(sPos) + prand.charAt(sPos * 2) + prand.charAt(sPos * 3) + prand.charAt(sPos * 4) + prand.charAt(sPos * 5));
            var incr = Math.round(pwd.length / 2);
            var modu = Math.pow(2, 31) - 1;
            var salt = parseInt(str.substring(str.length - 8, str.length), 16);
            str = str.substring(0, str.length - 8);
            prand += salt;
            while (prand.length > 10) {
                prand = (parseInt(prand.substring(0, 10)) + parseInt(prand.substring(10, prand.length))).toString();
            }
            prand = (mult * prand + incr) % modu;
            var enc_chr = "";
            var enc_str = "";
            for (var i = 0; i < str.length; i += 2) {
                enc_chr = parseInt(parseInt(str.substring(i, i + 2), 16) ^ Math.floor((prand / modu) * 255));
                enc_str += String.fromCharCode(enc_chr);
                prand = (mult * prand + incr) % modu;
            }
            return enc_str;
        }
    </script>

</head>

<body topmargin="5" text="#000000" background-color="#FFFFFF">
    <form name="box">

        <h4>XOR Encryption4</h4>

        <div style="text-align: center;align-items: center;">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                    <tr>
                        <td colspan="3">
                            URL<br><textarea cols="40" rows="5" name="ipt" wrap="virtual">Your url</textarea>
                        </td>
                    </tr>
                    <tr height="50">
                        <td valign="top">
                            <input type="button" onclick="document.box.opt.value= encrypt(document.box.ipt.value, document.box.pwd.value);" value="Encrypt">
                        </td>
                        <td valign="center" text-align="center">
                            <input type="text" name="pwd" value="password">
                        </td>
                        <td valign="bottom" text-align="right">
                            <input type="button" onclick="document.box.ipt.value= decrypt(document.box.opt.value, document.box.pwd.value);" value="Decrypt">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <textarea cols="40" rows="5" name="opt" wrap="virtual"></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </form>
    <hr>
    <footer>
        This is a cutten copy page from https://web.hku.hk/~jwilam/it/js_encryption.htm .</footer>
</body>

</html>